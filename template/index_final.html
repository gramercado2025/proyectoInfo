{% load static %}
{% load humanize %}

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog de Triskel Radio</title>

    <!-- Carga de Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
  
</head>

<body>

    <!-- 1. HEADER (Barra de Navegaci칩n) -->
    <header class="header">
        <div class="container header__container">

            <a href="#" class="header__logo logo-with-icon">
                <img src="{% static 'imagenes/logo radio.jpg' %}" alt="Logo de Mi Blog"
                    onerror="this.onerror=null;this.src='https://placehold.co/60x60/f8f8f8/E53935?text=Logo';"
                    class="logo-image">
                Nuestro Blog
            </a>

            <!-- Navegaci칩n -->
            <nav class="header__nav">
                <a href="#">Inicio</a>
                <a href="#">Categor칤as</a>
                <a href="#">Eventos</a>
                <a href="#">Contacto</a>
                <a href="{% url 'pautas' %}">Pautas de la Comunidad</a>
            </nav>

            <!-- Para mensajeria interna AGREGARLO A DetalleArticulo.index, y a los demas index--> 
            {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                     {% endfor %}
                </ul>
            {% endif %}

            <!-- Icono de B칰squeda (lucide: search) -->
            <button class="header__search-button" aria-label="Buscar">
                <!-- Icono de B칰squeda -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-search">
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.3-4.3" />
                </svg>
            </button>

            <!-- Men칰 m칩vil (Hamburguesa) -->
            <button class="header__menu-button" aria-label="Abrir men칰">
                <!-- Icono de Men칰 -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-menu">
                    <line x1="4" x2="20" y1="12" y2="12" />
                    <line x1="4" x2="20" y1="6" y2="6" />
                    <line x1="4" x2="20" y1="18" y2="18" />
                </svg>
            </button>
        </div>
    </header>

    <!-- 2. POST DESTACADO (Ocupa todo el ancho del contenedor) -->
    <section class="container featured-section">
        <h2 class="featured__title">Destacado</h2>
        {% if post_destacado %}
        <article class="featured__article">
            
            <!-- CONTENIDO DE LA NOTICIA DESTACADA -->
            <div class="featured__content">
                <div class="featured__category-container">
                    <span class="featured__category">
                        {{post_destacado.categoria_post}}
                    </span>
                </div>
                <h3 class="featured__heading">
                    游꿚 {{post_destacado.titulo}}
                </h3>
                <p>
                    {{post_destacado.resumen}}
                </p>
                <div class="post-card__meta">
                    <span class="post-card__author-meta">
                        <i data-lucide="user" class="icon"></i>
                        {{post_destacado.autor_post}}
                    </span>
                    <span class="post-card__date-meta">
                        <i data-lucide="calendar" class="icon"></i>
                        {{ post_destacado.fecha_creacion|date:"d/m/Y" }}
                    </span>
                    <span class="post-card__read-time-meta">
                        <i data-lucide="clock" class="icon"></i>
                        {{ post_destacado.fecha_creacion|naturaltime }}
                    </span>

                    <!-- BOT칍N PARA ABRIR EL PANEL DE COMENTARIOS -->
                    
                    <span  class="post-card__author-meta">
                        <i data-lucide="message-circle" class="icon"></i>
                        {{post_destacado.total_comentarios}} Comentarios
                    </span>
                </div>
            </div>

            <!-- IMAGEN DE LA NOTICIA DESTACADA (NUEVO) -->
            <div class="featured__media-container">

                <!-- Usamos una imagen de placeholder si la ruta local falla -->
                <img src="{{post_destacado.imagen_post.url}}" alt="Imagen {{post.titulo}}" class="featured__image"
                    onerror="this.onerror=null;this.src='https://placehold.co/600x300/E53935/white?text=Articulo+Destacado';">
            </div>

        </article>
    {% endif%}
    </section>

    <!-- 3. CONTENIDO PRINCIPAL (Art칤culos + Sidebar en 2 Columnas) -->
    <main class="container main-content">
        <div class="main-grid">

            <!-- COLUMNA DE ART칈CULOS (2/3 del ancho en escritorio) -->
            <section class="article-section">

                {% for post in posts %}
                 <!-- Art칤culo con imagen 1-->
                 <article class="post-card">

                    <div class="post-card__image-container">
                        {% if post.imagen_post%}
                        <img src="{{post.imagen_post.url}}" alt="Imagen {{post.titulo}}"
                            class="post-card__image"
                            onerror="this.onerror=null;this.src='https://placehold.co/300x200/4CAF50/white?text=Imagine+%26+Dragon';">
                        {% endif %}
                        </div>


                    <!-- Contenido del Art칤culo -->
                    <div class="post-card__content">
                        <span class="post-card__category">Lo nuevo de </span>
                        <a href="{% url 'detalle_articulo' post.id_post %}">
                            <h3 class="post-card__heading">
                                {{post.titulo}}
                            </h3>
                        </a>
                        <p class="post-card__excerpt">
                            {{post.resumen}}
                        </p>
                        <div class="post-card__meta">
                            <span class="post-card__author-meta">
                                <i data-lucide="user" class="icon"></i>
                                {{post.autor_post}}
                            </span>
                            <span class="post-card__date-meta">
                                <i data-lucide="calendar" class="icon"></i>
                                {{ post.fecha_creacion|date:"d/m/Y" }}
                            </span>
                            <span class="post-card__read-time-meta">
                                <i data-lucide="clock" class="icon"></i>
                                {{ post.fecha_creacion|naturaltime }}
                            </span>

                            <!-- BOT칍N PARA ABRIR EL PANEL DE COMENTARIOS -->
                            <span class="post-card__author-meta">
                                <i data-lucide="message-circle" class="icon"></i>
                                {{post.total_comentarios}} Comentarios
                            </span>
                        </div>
                    </div>
                </article>
                {% empty %}
                    <p>No hay publicaciones disponibles.</p>
                {% endfor %}
 

                <!-- Paginaci칩n -->
                <div class="pagination">
                    <a href="#" class="pagination__link">
                        <i data-lucide="chevron-left"
                            style="width:1rem; height:1rem; margin:0; vertical-align:middle;"></i>
                    </a>
                    <a href="#" class="pagination__link active">1</a>
                    <a href="#" class="pagination__link">2</a>
                    <a href="#" class="pagination__link">3</a>
                    <a href="#" class="pagination__link">
                        <i data-lucide="chevron-right"
                            style="width:1rem; height:1rem; margin:0; vertical-align:middle;"></i>
                    </a>
                </div>

            </section>

            <!-- COLUMNA DE SIDEBAR (1/3 del ancho en escritorio) -->
            <aside class="sidebar">

                <!-- Widget: Sobre Nosotros -->
                <div class="sidebar__widget">
                    <h3 class="widget__title">
                        <i data-lucide="radio" class="icon"></i>
                        Triskel Radio
                    </h3>
                    <p class="widget__text">
                        Somos la voz que acompa침a tu d칤a con la mejor selecci칩n musical y los contenidos m치s
                        interesantes.
                        Desde novedades discogr치ficas hasta las historias detr치s de tus artistas favoritos. 춰Sintoniza y
                        descubre!
                    </p>
                </div>

                <!-- Widget: Categor칤as -->
                <div class="sidebar__widget">
                    <h3 class="widget__title">
                        <i data-lucide="folder" class="icon"></i>
                        Categor칤as
                    </h3>
                    <ul class="widget__list">
                        <li><a href="#">Pop Argentino</a> <span class="widget__count">12</span></li>
                        <li><a href="#">Rock Cl치sico</a> <span class="widget__count">8</span></li>
                        <li><a href="#">Pop Internacional</a> <span class="widget__count">5</span></li>
                        <li><a href="#">Novedades Radio</a> <span class="widget__count">3</span></li>
                        <li><a href="#">Lo mejor de</a> <span class="widget__count">7</span></li>
                    </ul>
                </div>

                <!-- Widget: Art칤culos Populares -->
                <div class="sidebar__widget">
                    <h3 class="widget__title">
                        <i data-lucide="trending-up" class="icon"></i>
                        Los m치s Populares!
                    </h3>
                    <ul class="widget__list">
                        <li>
                            <a href="#"> </a>
                            <span class="widget__count text-light">2.5k vistas</span>
                        </li>
                        <li>
                            <a href="#"> </a>
                            <span class="widget__count text-light">1.8k vistas</span>
                        </li>
                        <li>
                            <a href="#"> </a>
                            <span class="widget__count text-light">1.5k vistas</span>
                        </li>
                        <li>
                            <a href="#"> </a>
                            <span class="widget__count text-light">1.2k vistas</span>
                        </li>
                    </ul>
                </div>
                <!-- Widget: Tags / Etiquetas -->
                <div class="sidebar__widget">
                    <h3 class="widget__title">
                        <i data-lucide="tag" class="icon"></i>
                        Etiquetas
                    </h3>
                    <div class="widget__tags">
                        <a href="#" class="widget__tag">#Pop</a>
                        <a href="#" class="widget__tag">#Rock</a>
                        <a href="#" class="widget__tag">#Internacional</a>
                        <a href="#" class="widget__tag">#Argentina</a>
                        <a href="#" class="widget__tag">#Los 80췂s</a>
                        <a href="#" class="widget__tag">#PopLatino</a>
                        <a href="#" class="widget__tag">#Festivales</a>
                    </div>
                </div>
            </aside>

        </div>
    </main>

    <!-- 4. FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="footer__grid">
                <!-- Columna 1: Info Blog -->
                <div>
                    <h3 class="footer__logo-footer">Blog Radio Triskel</h3>
                    <p class="widget__text">Tu estaci칩n de radio en l칤nea con la mejor mezcla de m칰sica y contenidos.
                    </p>
                </div>
                <!-- Columna 2: Enlaces R치pidos -->
                <div>
                    <h4 class="footer__section-title">Enlaces R치pidos</h4>
                    <ul class="footer__list">
                        <li><a href="#">Inicio</a></li>
                        <li><a href="#">Categor칤as</a></li>
                        <li><a href="#">Eventos</a></li>
                        <li><a href="#">Contacto</a></li>
                        <li><a href="{% url 'pautas' %}">Pautas de la Comunidad</a></li>

                    </ul>
                </div>
                <!-- Columna 3: Categor칤as -->
                <div>
                    <h4 class="footer__section-title">Categor칤as</h4>
                    <ul class="footer__list">
                        <li><a href="#">Lo mejor de</a></li>
                        <li><a href="#">Lo nuevo de </a></li>
                        <li><a href="#">Grupos Ic칩nicos</a></li>
                        <li><a href="#">Novedades de la radio</a></li>
                    </ul>
                </div>
                <!-- Columna 4: S칤guenos (Social) -->
                <div>
                    <h4 class="footer__section-title">S칤guenos</h4>
                    <div class="footer__social">
                        <!-- 칈conos Sociales -->
                        <a href="#" aria-label="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-facebook">
                                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />
                            </svg></a>

                        <a href="#" aria-label="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                                height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-instagram">
                                <rect width="20" height="20" x="2" y="2" rx="5" ry="5" />
                                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
                                <line x1="17.5" x2="17.51" y1="6.5" y2="6.5" />
                            </svg></a>
                        <a href="#" aria-label="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail">
                                <rect width="20" height="16" x="2" y="4" rx="2" />
                                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                            </svg></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer__copy">
            <p class="footer__copy-text">춸 2025 Blog de Triskel Radio. Proyecto Final - Grupo 2 - Informatorio Etapa 2 -
                Todos los derechos reservados.</p>
        </div>
    </footer>


    <!-- PANEL LATERAL DE COMENTARIOS (ACTUALIZADO) -->
    <div class="comments-panel">
        <div class="comments-panel__header">
            <h4 class="comments-panel__title">
                <i data-lucide="message-square" style="margin-right:0.5rem;"></i>
                Comentarios
            </h4>
            <!-- Bot칩n de Cierre -->
            <button class="comments-panel__close-button" aria-label="Cerrar panel">
                <i data-lucide="x"></i>
            </button>
        </div>


        <p class="comments-panel__info">
            Inicia sesi칩n para dejar un comentario. Recuerda revisar nuestras
            <a href="{% url 'pautas' %}">pautas de la comunidad</a>.
        </p>

        <textarea class="comments-panel__textarea" placeholder="Escribe tu comentario..."></textarea>

        <button class="comments-panel__login-button">
            Inicia sesi칩n para comentar
        </button>

        <div class="comments-panel__comment-list">
            <select class="comments-panel__sort-select">
                <option>Ordenar por: M치s nuevos</option>
                <option>Ordenar por: M치s votados</option>
            </select>

            <p class="comments-panel__no-comments">S칠 el primero en comentar este art칤culo.</p>

            <!-- Aqu칤 ir칤an los comentarios existentes -->
        </div>
    </div>


    <!-- L칩gica JavaScript para inicializar 칤conos y manejar el panel -->
    <script>
        // Inicializa 칤conos de Lucide
        lucide.createIcons();

        // --- L칩gica del Panel Lateral de Comentarios ---
        const commentsPanel = document.querySelector('.comments-panel');
        // Usamos el nuevo selector 'data-action' para los botones de comentario
        const openButtons = document.querySelectorAll('[data-action="open-comments"]');
        const closeButton = document.querySelector('.comments-panel__close-button');


        function openCommentsPanel(event) {
            if (event) {
                event.preventDefault(); // Previene la navegaci칩n si fuera un enlace
            }
            commentsPanel.classList.add('comments-panel--open');
        }

        function closeCommentsPanel() {
            commentsPanel.classList.remove('comments-panel--open');
        }

        // 1. Asignar listener a todos los botones de comentarios para abrir el panel
        openButtons.forEach(button => {
            button.addEventListener('click', openCommentsPanel);
        });

        // 2. Asignar listener al bot칩n de cierre
        closeButton.addEventListener('click', closeCommentsPanel);

        // 3. Opcional: Cerrar al presionar la tecla ESC
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && commentsPanel.classList.contains('comments-panel--open')) {
                closeCommentsPanel();
            }
        });

    </script>
</body>

</html>